<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>SpringBoot + MyBatis JSON í™•ì¸</title>
  <style>
    body {
      font-family: Arial;
      padding: 20px;
    }
    section {
      margin-bottom: 40px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #f0f0f0;
    }
  </style>
</head>
<body>
  <h1>SpringBoot + MyBatis JSON ì¶œë ¥ í™”ë©´</h1>

  <!-- âœ… 1. êµ¬êµ¬ë‹¨ -->
  <section>
    <h2>ğŸ“˜ êµ¬êµ¬ë‹¨</h2>
    <input type="number" id="danInput" placeholder="ë‹¨ ì…ë ¥" />
    <button onclick="fetchGugudan()">í™•ì¸</button>
    <ul id="guguResult"></ul>
  </section>

  <!-- âœ… 2. ë¶€ì„œì •ë³´ -->
  <section>
    <h2>ğŸ¢ ë¶€ì„œì •ë³´</h2>
    <button onclick="fetchBuser()">ë¶€ì„œ ì „ì²´ ì¡°íšŒ</button>
    <table id="buserTable">
      <thead>
        <tr>
          <th>ë¶€ì„œë²ˆí˜¸</th>
          <th>ë¶€ì„œëª…</th>
          <th>ì „í™”</th>
          <th>ì¸ì›ìˆ˜</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- âœ… 3. ì§ì›ì •ë³´ -->
  <section>
    <h2>ğŸ‘¤ ì§ì›ì •ë³´</h2>
    <input type="text" id="buserNameInput" placeholder="ë¶€ì„œëª… ì…ë ¥ (ì˜ˆ: ì´ë¬´ë¶€)" />
    <button onclick="fetchJikwon()">ì§ì› ì¡°íšŒ</button>
    <table id="jikwonTable">
      <thead>
        <tr>
          <th>ì‚¬ë²ˆ</th>
          <th>ì´ë¦„</th>
          <th>ë¶€ì„œëª…</th>
          <th>ì§ê¸‰</th>
          <th>ê³ ê°ìˆ˜</th>
          <th>ì—°ë´‰</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <script>
    function fetchGugudan() {
      const dan = document.getElementById("danInput").value;
      fetch(`/api/gugu?dan=${dan}`)
        .then(res => res.json())
        .then(data => {
          const ul = document.getElementById("guguResult");
          ul.innerHTML = "";
          data.result.forEach(line => {
            const li = document.createElement("li");
            li.textContent = line;
            ul.appendChild(li);
          });
        });
    }

    function fetchBuser() {
      fetch("/api/buser")
        .then(res => res.json())
        .then(data => {
          const tbody = document.querySelector("#buserTable tbody");
          tbody.innerHTML = "";
          data.forEach(b => {
            const row = `<tr>
              <td>${b.buserno}</td>
              <td>${b.busername}</td>
              <td>${b.busertel}</td>
              <td>${b.count}</td>
            </tr>`;
            tbody.innerHTML += row;
          });
        });
    }

    function fetchJikwon() {
      const buser = document.getElementById("buserNameInput").value.trim();
      const url = buser ? `/api/jikwon?buser=${buser}` : "/api/jikwon";
      fetch(url)
        .then(res => res.json())
        .then(data => {
          const tbody = document.querySelector("#jikwonTable tbody");
          tbody.innerHTML = "";
          data.forEach(j => {
            const row = `<tr>
              <td>${j.jikwonno}</td>
              <td>${j.jikwonname}</td>
              <td>${j.busername}</td>
              <td>${j.jik}</td>
              <td>${j.gogekcount}</td>
              <td>${j.jikwonpay}</td>
            </tr>`;
            tbody.innerHTML += row;
          });
        });
    }
  </script>
</body>
</html>
